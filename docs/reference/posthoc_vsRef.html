<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Post-hoc comparisons to a control or reference group. — posthoc_vsRef • grafify</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Post-hoc comparisons to a control or reference group. — posthoc_vsRef"><meta property="og:description" content="This function is a wrapper based on emmeans, and needs a ordinary linear model produced by simple_model or a mixed effects model produced by mixed_model or mixed_model_slopes (or generated directly with lm,  lme4 or lmerTest calls). It also needs to know the fixed factor(s), which should match those in the model and data table."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-YV575FWSXZ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YV575FWSXZ');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">grafify</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ashenoy-cmbi/grafify/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Post-hoc comparisons to a control or reference group.</h1>
    <small class="dont-index">Source: <a href="https://github.com/ashenoy-cmbi/grafify/blob/HEAD/R/posthoc_vsRef.R" class="external-link"><code>R/posthoc_vsRef.R</code></a></small>
    <div class="hidden name"><code>posthoc_vsRef.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is a wrapper based on <code><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></code>, and needs a ordinary linear model produced by <code><a href="simple_model.html">simple_model</a></code> or a mixed effects model produced by <code><a href="mixed_model.html">mixed_model</a></code> or <code><a href="mixed_model_slopes.html">mixed_model_slopes</a></code> (or generated directly with <code>lm</code>,  <code>lme4</code> or <code>lmerTest</code> calls). It also needs to know the fixed factor(s), which should match those in the model and data table.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">posthoc_vsRef</span><span class="op">(</span><span class="va">Model</span>, <span class="va">Fixed_Factor</span>, Ref_Level <span class="op">=</span> <span class="fl">1</span>, P_Adj <span class="op">=</span> <span class="st">"fdr"</span>, <span class="va">Factor</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Model</dt>
<dd><p>a model object fit using <code><a href="simple_model.html">simple_model</a></code> or <code><a href="mixed_model.html">mixed_model</a></code> or related.</p></dd>


<dt>Fixed_Factor</dt>
<dd><p>Fixed_Factor one or  more categorical variables, provided as a vector (e.g., c("A", "B")), whose levels you wish to compare pairwise. Names of Fixed_Factor should match Fixed_Factor used to fit the model. When more than one factor is provided e.g. <code>Fixed_factor = c("A", "B")</code>, this function passes this on as <code>specs = A|B</code> (note the vertical | between the two Fixed_Factor) to <code><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></code>. The specification internally is set to <code>specs = trt.vs.ctrl, Ref_Level = 1</code> to compare each group in A to the reference first group in A, separately at each level of B.</p></dd>


<dt>Ref_Level</dt>
<dd><p>the level within that factor to be considered the reference or control to compare other levels to (to be provided as a number - by default R orders levels alphabetically); default <code>Ref_Level = 1</code>.</p></dd>


<dt>P_Adj</dt>
<dd><p>method for correcting P values for multiple comparisons. Default is set to false discovery rate ("fdr"), can be changed to "none", "tukey", "bonferroni", "sidak" (in quotes). See Interaction analysis in emmeans in the <a href="https://CRAN.R-project.org/package=emmeans" class="external-link">manual</a> for <code>emmeans</code>.</p></dd>


<dt>Factor</dt>
<dd><p>old argument name for <code>Fixed_Factor</code>; retained for backward compatibility.</p></dd>


<dt>...</dt>
<dd><p>additional arguments for <code><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></code> such as <code>lmer.df</code> or others. See help for sophisticated models in <a href="https://CRAN.R-project.org/package=emmeans" class="external-link">emmeans</a>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>returns an "emm_list" object containing contrasts and emmeans through  <code><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html" class="external-link">emmeans</a></code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function will generate <a href="https://CRAN.R-project.org/package=emmeans" class="external-link">treatment vs control type of comparisons</a> (as described in Comparisons and contrasts in emmeans), i.e. comparison of each level of a factor to a reference level, which is set by default to the first level in the factor (<code>Ref_Level = 1</code>).
By default, P values are corrected by the FDR method (which can be changed). If the model was fit by transforming the quantitative response variable using "log", "logit", "sqrt" etc., results will still be on the original scale, i.e. <code>type = "response"</code> is the default; data will be back-transformed (check results to confirm this), and for log or logit see Transformations and link functions in emmeans, <a href="https://CRAN.R-project.org/package=emmeans" class="external-link">ratios will be compared</a>.
The first part of the <code>emmeans</code> results has the estimated marginal means, SE and CI (<code>$emmeans</code>), which are generated from the fitted model, and <strong>not</strong> the original data table. The second part has the results of the comparisons (<code>$contrasts</code>).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#make linear models first</span></span></span>
<span class="r-in"><span><span class="va">DoublMod</span> <span class="op">&lt;-</span> <span class="fu"><a href="simple_model.html">simple_model</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_doubling_time</span>,</span></span>
<span class="r-in"><span>Y_value <span class="op">=</span>  <span class="st">"Doubling_time"</span>, </span></span>
<span class="r-in"><span>Fixed_Factor <span class="op">=</span>  <span class="st">"Student"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CholMod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixed_model.html">mixed_model</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_cholesterol</span>, </span></span>
<span class="r-in"><span>Y_value <span class="op">=</span>  <span class="st">"Cholesterol"</span>, </span></span>
<span class="r-in"><span>Fixed_Factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hospital"</span>, <span class="st">"Treatment"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>Random_Factor <span class="op">=</span> <span class="st">"Subject"</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#to compare all students with student #9</span></span></span>
<span class="r-in"><span><span class="fu">posthoc_vsRef</span><span class="op">(</span>Model <span class="op">=</span> <span class="va">DoublMod</span>, </span></span>
<span class="r-in"><span>Fixed_Factor <span class="op">=</span> <span class="st">"Student"</span>, Ref_Level <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $emmeans</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Student emmean   SE df lower.CL upper.CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A         20.0 1.15 20     17.6     22.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  B         19.6 1.15 20     17.2     22.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  C         19.4 1.15 20     17.0     21.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  D         18.8 1.15 20     16.4     21.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  E         19.3 1.15 20     16.9     21.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  F         20.7 1.15 20     18.3     23.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  G         20.5 1.15 20     18.1     22.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H         19.2 1.15 20     16.8     21.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  I         20.6 1.15 20     18.2     23.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  J         21.2 1.15 20     18.8     23.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence level used: 0.95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $contrasts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A - I     -0.6775 1.62 20  -0.417  0.9588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  B - I     -1.0488 1.62 20  -0.646  0.9463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  C - I     -1.2704 1.62 20  -0.782  0.9463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  D - I     -1.8503 1.62 20  -1.139  0.9463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  E - I     -1.3061 1.62 20  -0.804  0.9463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  F - I      0.0642 1.62 20   0.040  0.9689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  G - I     -0.1890 1.62 20  -0.116  0.9689</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H - I     -1.4858 1.62 20  -0.915  0.9463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  J - I      0.5340 1.62 20   0.329  0.9588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: fdr method for 9 tests </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#for comparison between hospital_a to every other hospital, separately at levels of Treatment</span></span></span>
<span class="r-in"><span><span class="fu">posthoc_vsRef</span><span class="op">(</span>Model <span class="op">=</span> <span class="va">CholMod</span>, </span></span>
<span class="r-in"><span>Fixed_Factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hospital"</span>, <span class="st">"Treatment"</span><span class="op">)</span>, Ref_Level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $emmeans</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Treatment = After_drug:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hospital emmean   SE   df lower.CL upper.CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_a      147 23.3 20.3     98.4      196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_b      142 23.3 20.3     93.8      191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_c      105 23.3 20.3     56.4      154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_d      163 23.3 20.3    114.2      211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_e      162 23.3 20.3    113.8      211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Treatment = Before_drug:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hospital emmean   SE   df lower.CL upper.CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_a      173 23.3 20.3    124.6      222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_b      161 23.3 20.3    111.9      209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_c      124 23.3 20.3     75.6      173</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_d      162 23.3 20.3    113.1      210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_e      163 23.3 20.3    114.2      211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees-of-freedom method: kenward-roger </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence level used: 0.95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $contrasts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Treatment = After_drug:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast        estimate SE   df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_b - Hosp_a    -4.59 33 20.3  -0.139  0.8908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_c - Hosp_a   -42.00 33 20.3  -1.273  0.8599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_d - Hosp_a    15.77 33 20.3   0.478  0.8599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_e - Hosp_a    15.43 33 20.3   0.468  0.8599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Treatment = Before_drug:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast        estimate SE   df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_b - Hosp_a   -12.66 33 20.3  -0.384  0.7565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_c - Hosp_a   -49.00 33 20.3  -1.485  0.6112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_d - Hosp_a   -11.43 33 20.3  -0.347  0.7565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hosp_e - Hosp_a   -10.37 33 20.3  -0.314  0.7565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees-of-freedom method: kenward-roger </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: fdr method for 4 tests </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Avinash R Shenoy.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

